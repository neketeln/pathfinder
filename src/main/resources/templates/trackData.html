<html xmlns:th="https://www.thymeleaf.org">
<head>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">

    google.charts.load('current', {
      packages: ['corechart', 'line']
    });
    google.charts.setOnLoadCallback(drawElevationChart);
    google.charts.setOnLoadCallback(drawSpeedChart);

    function drawElevationChart() {

      var data = new google.visualization.DataTable();
      data.addColumn('number', 'Distance');
      data.addColumn('number', 'Elevation');
      data.addColumn('number', 'Angle');
      data.addRows([[${elevations}]]);

      var options = {
        width: 1600,
        height: 800,
        lineWidth: 5,
        legend: 'none',
        hAxis: {
          title: 'Distance'
        },
        vAxis: {
          title: 'Elevation'
        }
      };

      var dataView = new google.visualization.DataView(data);
      dataView.setColumns([
        // reference existing columns by index
        0, 1,
        // add function for line color
        {
          calc: function(data, row) {
            var validAngle = '#0000FF';
            var invalidAngle = '#FF0000';

            if ((data.getValue(row, 2) >= 20) || (data.getValue(row, 2) <= -20)) {
              return invalidAngle;
            }
            return validAngle;
          },
          type: 'string',
          role: 'style'
        }
      ]);

      var chart = new google.visualization.LineChart(document.getElementById('elevation_chart'));
      chart.draw(dataView, options);
    }

    function drawSpeedChart() {

      var data = new google.visualization.DataTable();
      data.addColumn('number', 'Distance');
      data.addColumn('number', 'Speed');
      data.addRows([[${speeds}]]);

      var options = {
        width: 1600,
        height: 800,
        legend: 'none',
        trendlines: {
          0: {
            type: 'polynomial',
            degree: 15
          }
        },
        hAxis: {
          title: 'Distance'
        },
        vAxis: {
          title: 'Speed'
        }
      };

      var chart = new google.visualization.ScatterChart(document.getElementById('speed_chart'));
      chart.draw(data, options);
    }

    </script>
</head>
<body>

<div id="elevation_chart"></div>
<div id="speed_chart"></div>

</body>
</html>